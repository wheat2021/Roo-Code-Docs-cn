# 速率限制与成本

理解和管理 API 使用情况对于获得流畅且经济高效的 Roo Code 体验至关重要。本节将说明如何跟踪您的令牌使用情况和成本。速率限制默认为 0（禁用），通常不需要调整，现在按配置文件进行配置；有关如何根据需要进行设置的详细信息，请参阅 [API 配置配置文件](/features/api-configuration-profiles#creating-a-profile) 文档。

---

## 令牌使用情况

Roo Code 使用令牌与 AI 模型进行交互。令牌本质上是单词的片段。请求和响应中使用的令牌数量会影响处理时间和成本。

*   **输入令牌：** 这些是您提示中的令牌，包括系统提示、您的指令以及提供的任何上下文（例如，文件内容）。
*   **输出令牌：** 这些是 AI 模型在其响应中生成的令牌。

您可以在聊天历史记录中看到每次交互使用的输入和输出令牌的数量。

---

## 成本计算

大多数 AI 提供商根据使用的令牌数量收费。定价因提供商和具体模型而异。

Roo Code 会根据配置模型的定价自动计算每个 API 请求的估算成本。此成本显示在聊天历史记录中，位于令牌使用情况旁边。

**注意：**

*   成本计算是*估算值*。实际成本可能会因提供商的计费方式而略有不同。
*   一些提供商可能会提供免费套餐或积分。有关详细信息，请查看您的提供商文档。
*   一些提供商提供提示缓存，这大大降低了成本。

### 限制自动批准的请求

为了进一步帮助管理 API 成本并防止意外开销，Roo Code 为自动批准的操作提供了一个“最大请求数”设置。这允许您定义一个具体的限制，即 Roo Code 在任务期间可以在不需要您明确重新批准的情况下连续进行多少次 API 调用。

*   **工作原理：** 如果您设置了限制（例如，5 个请求），Roo Code 将执行最多 5 个自动批准的 API 调用。在进行第 6 次调用之前，它将暂停并提示您“重置并继续”，如下所示。
    <img src="/img/v3.18.0/v3.18.0-1.png" alt="警告消息，指示已达到自动批准的请求限制。" width="600" />
    *当达到自动批准的请求限制时的通知。*
*   **配置：** 此限制在“自动批准操作”设置中配置。您可以设置一个具体的数字或选择“无限制”。有关配置此设置和其他自动批准设置的详细步骤，请参阅[自动批准操作文档](/features/auto-approving-actions)。
    <img src="/img/v3.18.0/v3.18.0.png" alt="在 Roo Code 设置中为自动批准的操作设置最大请求数限制。" width="600" />
    *为自动批准的操作设置“最大请求数”。*

此功能提供了额外的保障，尤其适用于可能涉及多个 API 调用的复杂或长时间运行的任务。

---

## 优化令牌使用技巧

*   **简洁明了：** 在提示中使用清晰简洁的语言。避免不必要的词语或细节。
*   **仅提供相关上下文：** 有选择地使用上下文提及（`@file.ts`、`@folder/`）。仅包括与任务直接相关的文件。
*   **分解任务：** 将大任务分解为更小、更专注的子任务。
*   **使用自定义指令：** 提供自定义指令以指导 Roo Code 的行为，并减少在每个提示中进行冗长解释的需要。
*   **选择合适的模型：** 有些模型比其他模型更具成本效益。考虑为不需要大型模型全部功能的任务使用更小、更快的模型。
*   **使用模式：** 不同的模式可以访问不同的工具，例如 `Architect` 无法修改代码，这使其成为分析复杂代码库时的安全选择，而无需担心意外允许昂贵的操作。
*   **不使用时禁用 MCP：** 如果您不使用 MCP（模型上下文协议）功能，请考虑[在 MCP 设置中禁用它](/features/mcp/using-mcp-in-roo#enabling-or-disabling-mcp-server-creation)，以显著减小系统提示的大小并节省令牌。

通过理解和管理您的 API 使用情况，您可以有效且高效地使用 Roo Code。